<Window x:Class="Spectralyzer.App.Host.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:xcad="http://schemas.xceed.com/wpf/xaml/avalondock"
        xmlns:host="clr-namespace:Spectralyzer.App.Host"
        xmlns:viewModels="clr-namespace:Spectralyzer.App.Host.ViewModels"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance viewModels:MainViewModel}"
        host:ViewModelLocator.DataContext="{x:Type viewModels:MainViewModel}"
        Title="Spectralyzer" Height="450" Width="800">
    <DockPanel LastChildFill="True">
        <ToolBar DockPanel.Dock="Top" VerticalAlignment="Top" Height="40">
            <Button Command="{Binding StartCaptureCommand}" Content="Start capture" Width="100" Margin="5" />
            <Button Command="{Binding StopCaptureCommand}" Content="Stop capture" Width="100" Margin="5" />
            <Label Content="Port:" VerticalAlignment="Center" Margin="5" />
            <xctk:IntegerUpDown Width="60" Minimum="1" Maximum="65535" Value="{Binding Port}" Margin="5" />
            <CheckBox Content="Decrypt HTTPS traffic" VerticalAlignment="Center" IsChecked="{Binding DecryptSsl}" Margin="5" />
            <Button Content="Clear" Width="100" Margin="5" Command="{Binding ClearSessionsCommand}" />
        </ToolBar>
        <xcad:DockingManager HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <xcad:LayoutRoot>
                <xcad:LayoutPanel>

                    <!-- Left Panel -->
                    <xcad:LayoutAnchorablePaneGroup>
                        <xcad:LayoutAnchorablePane>
                            <xcad:LayoutAnchorable Title="Sessions">
                                <Grid>
                                    <DataGrid EnableRowVirtualization="True" HeadersVisibility="Column" ItemsSource="{Binding WebSessions}" SelectedItem="{Binding SelectedWebSession}" AutoGenerateColumns="False" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Binding="{Binding Index, Mode=OneWay}" IsReadOnly="True" Header="#" Width="50" />
                                            <DataGridTextColumn Binding="{Binding Process, Mode=OneWay}" IsReadOnly="True" Header="Process" Width="100" />
                                            <DataGridTextColumn Binding="{Binding Request.RequestUri.Host, Mode=OneWay}" IsReadOnly="True" Header="Host" Width="150" />
                                            <DataGridTextColumn Binding="{Binding Request.RequestUri.PathAndQuery, Mode=OneWay}" IsReadOnly="True" Header="URL" Width="200" />
                                            <DataGridTextColumn Binding="{Binding Response.HttpStatusCode, Mode=OneWay, FallbackValue={x:Null}}" IsReadOnly="True" Header="Result" Width="100" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </xcad:LayoutAnchorable>
                        </xcad:LayoutAnchorablePane>
                    </xcad:LayoutAnchorablePaneGroup>

                    <!-- Right Panel -->
                    <xcad:LayoutAnchorablePaneGroup DockWidth="300" Orientation="Vertical">
                        <xcad:LayoutAnchorablePane>
                            <xcad:LayoutAnchorable Title="Request">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30*" MinHeight="100" />
                                        <RowDefinition Height="70*" MinHeight="100" />
                                    </Grid.RowDefinitions>
                                    <DataGrid EnableRowVirtualization="True" Grid.Row="0" HeadersVisibility="Column" ItemsSource="{Binding SelectedWebSession.Request.Headers, FallbackValue={x:Null}}" AutoGenerateColumns="False" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" DockPanel.Dock="Top">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Binding="{Binding Key, Mode=OneWay}" IsReadOnly="True" Header="Key" Width="150" />
                                            <DataGridTextColumn Binding="{Binding Values, Mode=OneWay}" IsReadOnly="True" Header="Value" Width="250" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <TextBox Grid.Row="1" VerticalScrollBarVisibility="Auto" IsReadOnly="True" Text="{Binding SelectedWebSession.Request.BodyAsString, Mode=OneWay, FallbackValue={x:Null}}" VerticalContentAlignment="Top" AcceptsReturn="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" DockPanel.Dock="Bottom" />
                                </Grid>
                            </xcad:LayoutAnchorable>
                        </xcad:LayoutAnchorablePane>
                        <xcad:LayoutAnchorablePane>
                            <xcad:LayoutAnchorable Title="Response">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30*" MinHeight="100" />
                                        <RowDefinition Height="70*" MinHeight="100" />
                                    </Grid.RowDefinitions>
                                    <DataGrid EnableRowVirtualization="True" Grid.Row="0" HeadersVisibility="Column" ItemsSource="{Binding SelectedWebSession.Response.Headers, FallbackValue={x:Null}}" AutoGenerateColumns="False" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" DockPanel.Dock="Top">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Binding="{Binding Key, Mode=OneWay}" IsReadOnly="True" Header="Key" Width="150" />
                                            <DataGridTextColumn Binding="{Binding Values, Mode=OneWay}" IsReadOnly="True" Header="Value" Width="250" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <TextBox Grid.Row="1" VerticalScrollBarVisibility="Auto" Text="{Binding SelectedWebSession.Response.BodyAsString, Mode=OneWay, FallbackValue={x:Null}}" IsReadOnly="True" VerticalContentAlignment="Top" AcceptsReturn="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" DockPanel.Dock="Bottom" />
                                </Grid>
                            </xcad:LayoutAnchorable>
                        </xcad:LayoutAnchorablePane>
                    </xcad:LayoutAnchorablePaneGroup>
                </xcad:LayoutPanel>
            </xcad:LayoutRoot>
        </xcad:DockingManager>
    </DockPanel>
</Window>